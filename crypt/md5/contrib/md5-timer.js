/* timings */

function timer(f) {return function(x) {var n1 = new Date();f(x); // do something herereturn new Date() - n1;};}

var time_md5 = timer(function(s) { for (var i=0; i<4; i++) MD5(s) });

var s = '-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------';

// testing

var t1, t2, t3, total;
var size = 5.25 * 4 * 1024;

document.write('<h2>MD5 JavaScript Speed Tests</h2>',
'<pre>',
'time in ms: (avg of four trials)\n');

document.write(
'    1/4 KB: ', Math.round((t1 = time_md5(s.substring(0, 256))/4)),
' ms\n');

document.write(
'      1 KB: ', Math.round((t2 = time_md5(s))/4),
' ms\n');

if (confirm('Do large 4 KB test?')) document.write(
'      4 KB: ', Math.round((t3 = time_md5(s + s + s + s))/4),
' ms\n');
else t3 = 0, size = 1.25 * 4 * 1024;

total = t1 + t2 + t3;

document.write(
'     Total: ', size, ' B, ', total, ' ms\n',
'   Average: ', size * 1000 / total, ' B/s\n');
document.write('</pre>',
'<h2>Done.</h2>');
